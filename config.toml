# 麦麦自主规划插件配置
# 版本：v3.0.0

[plugin]
enabled = true  # 是否启用插件

[autonomous_planning]
cleanup_interval = 3600  # 清理间隔（秒），默认1小时
cleanup_old_goals_days = 30  # 保留历史记录天数

# 日程生成配置
[autonomous_planning.schedule]
# 日程注入功能
inject_schedule = true  # 在对话时自然提到当前活动（推荐开启）
auto_generate = true  # 询问日程时自动检查并生成（推荐开启）

# 多轮生成配置
use_multi_round = true  # 启用多轮生成机制，提升质量（关闭可加速）
max_rounds = 2  # 最多尝试轮数（1-3）
quality_threshold = 0.85  # 质量阈值（0.80-0.90，降低可加速）

# 生成参数
min_activities = 8  # 最少活动数量
max_activities = 15  # 最多活动数量
enable_detailed_description = true  # 是否启用详细描述（false则生成、注入、命令都不显示详细描述）
min_description_length = 20  # 描述最小长度
max_description_length = 50  # 描述最大长度
max_tokens = 8192  # 日程生成的最大token数
generation_timeout = 180.0  # 日程生成超时时间（秒）

# 🆕 自定义prompt配置（影响生成的日程内容）
custom_prompt = ""  # 自定义提示词，可以影响日程生成风格和内容
# 示例：
# custom_prompt = "生成的日程要偏向学习和工作，减少娱乐时间"
# custom_prompt = "今天想多安排一些运动和户外活动"
# custom_prompt = "我今天心情不好，安排一些轻松愉快的活动"
# custom_prompt = "今天有重要考试，多安排复习时间"

# 缓存配置
cache_ttl = 300  # 缓存TTL（秒），默认5分钟
cache_max_size = 100  # 缓存最大条目数

# ⚠️ 定时自动生成配置 - 必须在 [autonomous_planning.schedule] 下
auto_schedule_enabled = true  # 是否启用定时自动生成日程
auto_schedule_time = "00:30"  # 每天自动生成日程的时间（HH:MM格式）
timezone = "Asia/Shanghai"  # 时区设置

# 权限配置
admin_users = ["1334431750"]  # 管理员QQ号列表，格式: ["12345", "67890"]，留空则所有人可用

# 🆕 智能注入配置（v3.2.0新增，v3.3.0优化）
[autonomous_planning.schedule.inject]
# ============================================================
# 注入模式选择（v3.3.0新增）⭐
# ============================================================
inject_mode = "smart"  # 可选: 'smart'(推荐), 'rule', 'traditional'
# - smart: LLM软注入，让LLM自己判断是否使用日程信息（零额外成本，准确率高）
# - rule: 规则引擎判断（原v3.2.0智能模式，使用意图分类器）
# - traditional: 固定注入（向后兼容，总是注入日程）

# ============================================================
# 智能组件开关（rule模式下使用）
# ============================================================
enable_intent_classification = true  # 启用意图分类器（智能识别用户意图）
enable_state_analysis = true  # 启用状态分析器（生成情感化描述）
enable_inject_optimization = true  # 启用注入优化器（防止无效注入）

# ============================================================
# 注入策略配置
# ============================================================
casual_chat_inject_probability = 0.5  # 闲聊时注入概率（0-1），默认50%
max_future_activities = 3  # 最多显示未来活动数量

# ============================================================
# 🆕 对话上下文配置（v3.3.0新增）⭐
# ============================================================
context_max_turns = 3  # 保留最近N轮对话历史，默认3轮
context_ttl = 600  # 对话历史过期时间（秒），默认10分钟
# 作用：支持连续多轮对话，例如：
#   用户："你在干嘛？" → Bot提及日程
#   用户："学什么呢？" → 识别为连续对话，继续提及日程

# 自定义模型配置（可选）
[autonomous_planning.schedule.custom_model]
enabled = false  # 是否启用自定义模型
model_name = ""  # 模型名称，如: "gpt-4"
api_base = ""  # API地址，如: "https://api.openai.com/v1"
api_key = ""  # API密钥
provider = ""  # 提供商类型，如: "openai"
temperature = 0.7  # 温度参数（0.0-1.0）
